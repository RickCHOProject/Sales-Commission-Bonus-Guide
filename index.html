<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Commission & Bonus All-in-One Calculator</title>
    <!-- Chosen Palette: Warm Neutrals with Muted Teal Accent -->
    <!-- Application Structure Plan: The application is designed as a single-page interactive tool with a fixed top navigation bar. The primary section, "Your Earnings Calculator," consolidates all inputs and calculations for base commission, penalty, comeback, and both bonus types into one comprehensive interactive card. This structure was chosen to provide an immediate, holistic view of potential earnings based on various performance metrics, directly addressing the user's need for an "everything on one page" calculator. Secondary sections for "Confusing Scenarios & Support" and "Key Takeaways" remain accessible via navigation, offering detailed context without cluttering the main calculator interface. The layout maintains the clean, card-based design and responsive principles. -->
    <!-- Visualization & Content Choices: 
        - Your Earnings Calculator Section:
            - Report Info: All commission rules (3% base, 25% penalty, comeback), Stretch Goal Bonus tiers, Deals Closed Bonus tiers. Goal: Allow user to calculate total potential earnings under various scenarios. Viz/Presentation: A single, large interactive card containing consolidated input fields (Total Monthly Revenue, Total Contracts Signed Monthly, Total Deals Closed Monthly, Talk Time Met) and dynamic text displays for key components: Base Commission (3%), Stretch Goal Bonus, Deals Closed Bonus, and the final Total Estimated Monthly Earnings. A clear, dynamic message (potentially red) will highlight any penalty deduction, showing the exact amount and clarifying it's from the total potential. Interaction: User inputs values; JS recalculates and updates all earnings figures in real-time. Justification: Centralizes all earning calculations, providing a powerful, immediate "what-if" tool for sales reps, with simplified input and enhanced transparency for penalty calculations in a concise manner. Library/Method: Vanilla JS, HTML, Tailwind CSS.
        - Confusing Scenarios & Support Section:
            - Report Info: Specific scenarios, overrides, dashboard info. Goal: Address common questions and provide support channels. Viz/Presentation: Accordion components for each scenario/topic. Interaction: Click to expand/collapse detailed explanations. Justification: Organizes complex information clearly, preventing visual clutter while ensuring all details are accessible. Library/Method: Vanilla JS (for accordions), HTML, Tailwind CSS.
        - Key Takeaways Section:
            - Report Info: Consistency, Bonuses = More Money, Support availability, 2025 outlook. Goal: Summarize core messages and motivate. Viz/Presentation: Bulleted list within a styled card. Interaction: None. Justification: Reinforces critical aspects concisely. Library/Method: HTML, Tailwind CSS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F7F4; /* Warm neutral background: Warm Stone */
            color: #3C3C3C; /* Dark stone for text */
        }
        /* Styling for main content cards, similar to original chart-container */
        .content-card {
            position: relative;
            width: 100%;
            max-width: 900px; /* Increased max-width for the combined calculator */
            margin-left: auto;
            margin-right: auto;
            min-height: 180px; /* Ensures a consistent baseline height */
            background-color: #ffffff;
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); /* shadow-md */
            padding: 1.5rem; /* p-6 */
            display: flex;
            flex-direction: column;
            justify-content: center; /* Vertically center content */
        }
        /* Adjust height for smaller screens for better mobile experience */
        @media (max-width: 768px) {
            .content-card {
                min-height: 160px;
            }
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #E5E5E5; /* Light gray track */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb {
            background: #A1A1A1; /* Medium gray thumb */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #808080; /* Darker gray on hover */
        }
        /* Accordion transition for smooth open/close */
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .accordion-content.open {
            max-height: fit-content; /* This value might need adjustment or a large fixed value for very long content */
        }
        .calculate-button {
            background-color: #059669; /* Emerald 600 - keeping this accent color for buttons as per original successful prompt */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            transition: background-color 0.3s ease-in-out;
        }
        .calculate-button:hover {
            background-color: #047857; /* Emerald 700 */
        }
    </style>
</head>
<body class="overflow-y-auto">

    <!-- Header Navigation -->
    <header class="bg-stone-800 text-white shadow-lg fixed top-0 left-0 right-0 z-50">
        <nav class="container mx-auto px-4 py-4 flex flex-col sm:flex-row justify-between items-center">
            <h1 class="text-2xl font-semibold mb-2 sm:mb-0">Sales Commission & Bonus Guide</h1>
            <div class="flex flex-wrap justify-center sm:justify-end gap-3">
                <button class="nav-button bg-emerald-700 hover:bg-emerald-600 text-white py-2 px-4 rounded-md font-medium text-sm transition duration-300 ease-in-out shadow-md" data-target="calculator">Your Earnings Calculator</button>
                <button class="nav-button bg-stone-700 hover:bg-stone-600 text-white py-2 px-4 rounded-md font-medium text-sm transition duration-300 ease-in-out shadow-md" data-target="scenarios-support">Scenarios & Support</button>
                <button class="nav-button bg-stone-700 hover:bg-stone-600 text-white py-2 px-4 rounded-md font-medium text-sm transition duration-300 ease-in-out shadow-md" data-target="key-takeaways">Key Takeaways</button>
            </div>
        </nav>
    </header>

    <main class="pt-32 pb-16 container mx-auto px-4">
        <!-- Your Earnings Calculator Section -->
        <section id="calculator" class="content-section active">
            <h2 class="text-4xl font-bold text-stone-800 mb-6 text-center">Your Earnings Calculator! üí∞</h2>
            <p class="text-lg text-center text-stone-600 mb-10 max-w-3xl mx-auto">
                Input your performance metrics below to instantly calculate your potential commissions and bonuses. See how each factor contributes to your total earnings based on the updated commission structure!
            </p>

            <div class="content-card p-8">
                <h3 class="text-2xl font-semibold text-stone-800 mb-6 text-center">Calculate Your Total Earnings</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <!-- Total Monthly Revenue -->
                    <div>
                        <label for="total-monthly-revenue" class="block text-stone-700 text-lg mb-2">Total Monthly Revenue ($):</label>
                        <input type="number" id="total-monthly-revenue" class="border border-stone-300 rounded-md p-2 text-lg w-full text-center focus:outline-none focus:ring-2 focus:ring-emerald-500" placeholder="e.g., 45000" value="45000">
                    </div>
                    <!-- Total Contracts Signed (Monthly) -->
                    <div>
                        <label for="total-contracts-closed-month" class="block text-stone-700 text-lg mb-2">Total Contracts Signed (Monthly):</label>
                        <input type="number" id="total-contracts-closed-month" class="border border-stone-300 rounded-md p-2 text-lg w-full text-center focus:outline-none focus:ring-2 focus:ring-emerald-500" placeholder="e.g., 4" value="4">
                    </div>
                    <!-- Total Deals Closed (Monthly) -->
                    <div>
                        <label for="total-deals-closed-month" class="block text-stone-700 text-lg mb-2">Total Deals Closed (Monthly):</label>
                        <input type="number" id="total-deals-closed-month" class="border border-stone-300 rounded-md p-2 text-lg w-full text-center focus:outline-none focus:ring-2 focus:ring-emerald-500" placeholder="e.g., 4" value="4">
                    </div>
                    <!-- Talk Time Goal Met (for Deals Closed Bonus) -->
                    <div class="flex items-center justify-center md:justify-start">
                        <input type="checkbox" id="talk-time-met" class="form-checkbox h-5 w-5 text-emerald-600 rounded focus:ring-emerald-500" checked>
                        <label for="talk-time-met" class="ml-2 text-stone-700 text-lg">Talk Time Goal Met</label>
                    </div>
                </div>

                <div class="text-center mb-8">
                    <button id="calculate-all-earnings" class="calculate-button">Calculate All Earnings</button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-left">
                    <div class="bg-slate-50 p-4 rounded-lg shadow-sm">
                        <p class="text-stone-600 font-medium">3% Commission (from Monthly Revenue):</p>
                        <p class="text-2xl font-bold text-emerald-700" id="display-base-commission">$0.00</p>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-lg shadow-sm">
                        <p class="text-stone-600 font-medium">Stretch Goal Bonus:</p>
                        <p class="text-2xl font-bold text-emerald-700" id="display-stretch-bonus">$0.00</p>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-lg shadow-sm">
                        <p class="text-stone-600 font-medium">Deals Closed Bonus:</p>
                        <p class="text-2xl font-bold text-emerald-700" id="display-deals-bonus">$0.00</p>
                        <p class="text-sm text-stone-500" id="display-deals-bonus-message"></p>
                    </div>
                    <!-- Penalty Message Display -->
                    <div class="bg-slate-50 p-4 rounded-lg shadow-sm">
                        <p class="text-stone-600 font-medium">Contract Compliance Status:</p>
                        <p class="text-sm text-stone-500" id="display-penalty-message"></p>
                    </div>
                </div>

                <div class="bg-emerald-700 text-white p-6 rounded-lg mt-8 text-center shadow-md">
                    <p class="text-2xl font-bold">TOTAL ESTIMATED MONTHLY EARNINGS:</p>
                    <p class="text-4xl font-extrabold mt-2" id="display-total-earnings">$0.00</p>
                </div>
            </div>
        </section>

        <!-- Scenarios & Support Section -->
        <section id="scenarios-support" class="content-section hidden">
            <h2 class="text-4xl font-bold text-stone-800 mb-6 text-center">Confusing Scenarios? We Got You! ü§ù</h2>
            <p class="text-lg text-center text-stone-600 mb-10 max-w-3xl mx-auto">
                Here are answers to some common questions and tricky situations you might encounter. Also, find out how you can get support if you need a little help meeting your targets.
            </p>

            <div class="bg-white p-6 rounded-lg shadow-md space-y-6 max-w-3xl mx-auto">
                <!-- Accordion Item 1: The Last-Minute Contract -->
                <div class="border border-stone-200 rounded-lg overflow-hidden">
                    <button class="accordion-header flex justify-between items-center w-full p-5 bg-stone-50 hover:bg-stone-100 transition duration-200 ease-in-out focus:outline-none">
                        <span class="text-xl font-semibold text-stone-700">Scenario 1: The Last-Minute Contract</span>
                        <span class="text-stone-500 text-2xl transform transition-transform duration-300 rotate-0">&#9660;</span>
                    </button>
                    <div class="accordion-content p-5 text-stone-600">
                        <p><strong>Question:</strong> A contract is added on the last day, but no others for the pay period.</p>
                        <p><strong>Answer:</strong> Yes, you will be penalized. The contract minimum of two new contracts **per pay period** must be met. If your monthly total doesn't average out to two per period, the penalty applies to that period's commission.</p>
                    </div>
                </div>

                <!-- Accordion Item 2: The Comeback Kid -->
                <div class="border border-stone-200 rounded-lg overflow-hidden">
                    <button class="accordion-header flex justify-between items-center w-full p-5 bg-stone-50 hover:bg-stone-100 transition duration-200 ease-in-out focus:outline-none">
                        <span class="text-xl font-semibold text-stone-700">Scenario 2: The Comeback Kid</span>
                        <span class="text-stone-500 text-2xl transform transition-transform duration-300 rotate-0">&#9660;</span>
                    </button>
                    <div class="accordion-content p-5 text-stone-600">
                        <p><strong>Question:</strong> You had a slow first half, but ended the month with 5 new contracts.</p>
                        <p><strong>Answer:</strong> You'll get your deducted commission and bonus back in your end-of-month paycheck.</p>
                    </div>
                </div>

                <!-- Accordion Item 3: The Close Call -->
                <div class="border border-stone-200 rounded-lg overflow-hidden">
                    <button class="accordion-header flex justify-between items-center w-full p-5 bg-stone-50 hover:bg-stone-100 transition duration-200 ease-in-out focus:outline-none">
                        <span class="text-xl font-semibold text-stone-700">Scenario 3: The Close Call</span>
                        <span class="text-stone-500 text-2xl transform transition-transform duration-300 rotate-0">&#9660;</span>
                    </button>
                    <div class="accordion-content p-5 text-stone-600">
                        <p><strong>Question:</strong> You closed a major deal at the month‚Äôs end and hit a bonus target.</p>
                        <p><strong>Answer:</strong> You absolutely get that bonus! Bonuses are calculated based on monthly totals.</p>
                    </div>
                </div>

                <!-- Accordion Item 4: The Late Bloomer -->
                <div class="border border-stone-200 rounded-lg overflow-hidden">
                    <button class="accordion-header flex justify-between items-center w-full p-5 bg-stone-50 hover:bg-stone-100 transition duration-200 ease-in-out focus:outline-none">
                        <span class="text-xl font-semibold text-stone-700">Scenario 4: The Late Bloomer</span>
                        <span class="text-stone-500 text-2xl transform transition-transform duration-300 rotate-0">&#9660;</span>
                    </button>
                    <div class="accordion-content p-5 text-stone-600">
                        <p><strong>Question:</strong> You had zero deals and zero contracts by the 15th, but finished the month strong.</p>
                        <p><strong>Answer:</strong> You will still earn your full commission and bonus at the end of the month as long as you hit your monthly contract minimum.</p>
                    </div>
                </div>

                <!-- Overrides & Your Dashboard -->
                <div class="border border-stone-200 rounded-lg overflow-hidden">
                    <button class="accordion-header flex justify-between items-center w-full p-5 bg-stone-50 hover:bg-stone-100 transition duration-200 ease-in-out focus:outline-none">
                        <span class="text-xl font-semibold text-stone-700">Need a Little Help? Overrides & Your Dashboard</span>
                        <span class="text-stone-500 text-2xl transform transition-transform duration-300 rotate-0">&#9660;</span>
                    </button>
                    <div class="accordion-content p-5 text-stone-600">
                        <p><strong>Overrides:</strong> If you run into issues, Rick or Chris can override the contract or talk time minimums. Just talk to them!</p>
                        <p class="mt-3"><strong>Your Dashboard:</strong> Check your dashboard for a full view of commissions, contracts, talk time, bonuses, and any overrides. It's your best friend for tracking progress!</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Key Takeaways Section -->
        <section id="key-takeaways" class="content-section hidden">
            <h2 class="text-4xl font-bold text-stone-800 mb-6 text-center">Key Takeaways & Beyond</h2>
            <p class="text-lg text-center text-stone-600 mb-10 max-w-3xl mx-auto">
                Summarizing the most important aspects of your commission and bonus structure, along with exciting news about the future. Focus on these points to maximize your earning potential!
            </p>

            <div class="content-card p-8">
                <ul class="list-disc list-inside text-stone-700 space-y-3">
                    <li><strong>Consistency is king:</strong> Keep closing those deals and securing new contracts.</li>
                    <li><strong>Bonuses = More Money:</strong> Aim high and exceed your targets to unlock additional earnings.</li>
                    <li><strong>Questions?</strong> Rick or Chris are always here to help clarify any doubts.</li>
                    <li>Good news! This commission structure is sticking around for <strong>2025 and Beyond</strong>. Let‚Äôs make this year our best yet!</li>
                </ul>
            </div>
        </section>
    </main>

    <footer class="bg-stone-800 text-white text-center py-6 mt-16 shadow-inner">
        <p class="text-sm">&copy; 2024 Company Name. All rights reserved. Your success is our success!</p>
    </footer>

    <script>
        // Data for the Commission Structure
        const commissionData = {
            baseCommissionRate: 0.03, // 3%
            penaltyRate: 0.25, // 25% penalty
            contractMinimumPerPeriod: 2, // Per pay period (twice a month)
            monthlyContractComeback: 4, // 4+ new contracts by month-end to reclaim penalty
            stretchGoalBonuses: [
                { revenue: 30000, bonus: 1200 },
                { revenue: 45000, bonus: 2200 },
                { revenue: 60000, bonus: 3700 },
                { revenue: 90000, bonus: 5700 }
            ],
            dealsClosedBonus: {
                baseDeals: 4,
                baseBonus: 150,
                additionalDealBonus: 200
            }
        };

        // DOM Elements
        const navButtons = document.querySelectorAll('.nav-button');
        const contentSections = document.querySelectorAll('.content-section');
        const accordions = document.querySelectorAll('.accordion-header');

        // Calculator Section Inputs
        const totalMonthlyRevenueInput = document.getElementById('total-monthly-revenue');
        const totalContractsClosedMonthInput = document.getElementById('total-contracts-closed-month');
        const totalDealsClosedMonthInput = document.getElementById('total-deals-closed-month');
        const talkTimeMetCheckbox = document.getElementById('talk-time-met');
        const calculateAllEarningsButton = document.getElementById('calculate-all-earnings');

        // Calculator Section Displays
        const displayBaseCommission = document.getElementById('display-base-commission');
        const displayStretchBonus = document.getElementById('display-stretch-bonus');
        const displayDealsBonus = document.getElementById('display-deals-bonus');
        const displayDealsBonusMessage = document.getElementById('display-deals-bonus-message');

        const displayPenaltyMessage = document.getElementById('display-penalty-message'); // This will show the penalty/comeback status and deduction
        
        const displayTotalEarnings = document.getElementById('display-total-earnings');

        // Main Calculation Function
        function calculateAllEarnings() {
            const totalMonthlyRevenue = parseFloat(totalMonthlyRevenueInput.value);
            const totalContractsSignedMonth = parseInt(totalContractsClosedMonthInput.value);
            const totalDealsClosedMonth = parseInt(totalDealsClosedMonthInput.value);
            const talkTimeMet = talkTimeMetCheckbox.checked;

            let currentBaseCommission = 0;
            let potentialStretchBonus = 0;
            let potentialDealsBonus = 0;

            let finalTotalEarnings = 0; // This will hold the final sum after all calculations and penalties

            let penaltyMessageText = ''; // Text for the penalty status message
            let dealsBonusMessageText = ''; // Text for the deals bonus message

            // 1. Calculate Initial Base Commission
            if (!isNaN(totalMonthlyRevenue) && totalMonthlyRevenue >= 0) {
                currentBaseCommission = totalMonthlyRevenue * commissionData.baseCommissionRate;
            } else {
                currentBaseCommission = 0;
            }

            // 2. Calculate Potential Stretch Goal Bonus
            if (!isNaN(totalMonthlyRevenue) && totalMonthlyRevenue >= 0) {
                const sortedTiers = [...commissionData.stretchGoalBonuses].sort((a, b) => b.revenue - a.revenue);
                for (const tier of sortedTiers) {
                    if (totalMonthlyRevenue >= tier.revenue) {
                        potentialStretchBonus = tier.bonus;
                        break;
                    }
                }
            } else {
                potentialStretchBonus = 0;
            }

            // 3. Calculate Potential Deals Closed Bonus
            if (!isNaN(totalDealsClosedMonth) && totalDealsClosedMonth >= 0 && talkTimeMet) {
                if (totalDealsClosedMonth >= commissionData.dealsClosedBonus.baseDeals) {
                    potentialDealsBonus = commissionData.dealsClosedBonus.baseBonus;
                    const additionalDeals = totalDealsClosedMonth - commissionData.dealsClosedBonus.baseDeals;
                    if (additionalDeals > 0) {
                        potentialDealsBonus += additionalDeals * commissionData.dealsClosedBonus.additionalDealBonus;
                    }
                    dealsBonusMessageText = `Talk time goal met.`;
                    displayDealsBonusMessage.classList.remove('text-red-600', 'text-stone-500');
                    displayDealsBonusMessage.classList.add('text-emerald-700');
                } else {
                    potentialDealsBonus = 0;
                    dealsBonusMessageText = `Need ${commissionData.dealsClosedBonus.baseDeals} deals for bonus.`;
                    displayDealsBonusMessage.classList.remove('text-emerald-700', 'text-red-600');
                    displayDealsBonusMessage.classList.add('text-stone-500');
                }
            } else if (!talkTimeMet) {
                potentialDealsBonus = 0;
                dealsBonusMessageText = `Talk time goal not met. (Deals Closed Bonus N/A)`;
                displayDealsBonusMessage.classList.remove('text-emerald-700', 'text-stone-500');
                displayDealsBonusMessage.classList.add('text-red-600');
            } else {
                potentialDealsBonus = 0;
                dealsBonusMessageText = `(No monthly deal data for bonus calculation)`;
                displayDealsBonusMessage.classList.remove('text-emerald-700', 'text-red-600');
                displayDealsBonusMessage.classList.add('text-stone-500');
            }

            // 4. Determine Contract Compliance & Comeback Status
            let contractMinimumMet = false; 
            let comebackAchieved = false;   

            if (!isNaN(totalContractsSignedMonth) && totalContractsSignedMonth >= 0) {
                const contractsPerPayPeriodAvg = totalContractsSignedMonth / 2;
                if (contractsPerPayPeriodAvg >= commissionData.contractMinimumPerPeriod) {
                    contractMinimumMet = true;
                }
                if (totalContractsSignedMonth >= commissionData.monthlyContractComeback) {
                    comebackAchieved = true;
                }
            } else {
                contractMinimumMet = false; 
            }

            // 5. Calculate Total Potential Payout BEFORE any contract-based penalty
            // This now includes 3% Commission + Stretch Goal Bonus + Deals Closed Bonus
            let totalPotentialPayoutForPenaltyCheck = currentBaseCommission + potentialStretchBonus + potentialDealsBonus;
            let penaltyAmount = 0;

            if (contractMinimumMet || comebackAchieved) {
                // If contract minimum met, or comeback achieved, no penalty on overall payout
                finalTotalEarnings = totalPotentialPayoutForPenaltyCheck;

                if (contractMinimumMet) { 
                    penaltyMessageText = `Full commission and bonuses earned!`;
                    displayPenaltyMessage.classList.remove('text-red-600', 'text-stone-500');
                    displayPenaltyMessage.classList.add('text-emerald-700');
                } else if (!contractMinimumMet && comebackAchieved) { 
                    penaltyMessageText = `Penalty Reclaimed! (4+ monthly contracts signed)`;
                    displayPenaltyMessage.classList.remove('text-red-600', 'text-stone-500');
                    displayPenaltyMessage.classList.add('text-emerald-700');
                }

            } else {
                // Contract minimum not met AND comeback NOT achieved, apply 25% penalty to the total potential payout
                penaltyAmount = totalPotentialPayoutForPenaltyCheck * commissionData.penaltyRate;
                finalTotalEarnings = totalPotentialPayoutForPenaltyCheck - penaltyAmount;

                penaltyMessageText = `Penalty Applied! (${(commissionData.penaltyRate * 100)}% deduction of $${penaltyAmount.toFixed(2)}) from your **total potential earnings ($${currentBaseCommission.toFixed(2)} 3% Commission + $${potentialStretchBonus.toFixed(2)} Stretch Goal Bonus + $${potentialDealsBonus.toFixed(2)} Deals Closed Bonus)**.`;
                displayPenaltyMessage.classList.remove('text-emerald-700', 'text-stone-500');
                displayPenaltyMessage.classList.add('text-red-600');
            }

            // Ensure final earnings are not negative
            finalTotalEarnings = Math.max(0, finalTotalEarnings);

            // Update Displays
            displayBaseCommission.textContent = `$${currentBaseCommission.toFixed(2)}`;
            displayStretchBonus.textContent = `$${potentialStretchBonus.toFixed(2)}`;
            displayDealsBonus.textContent = `$${potentialDealsBonus.toFixed(2)}`;
            displayDealsBonusMessage.textContent = dealsBonusMessageText; // Keep this specific message

            displayPenaltyMessage.textContent = penaltyMessageText; // This now holds the detailed penalty/comeback status
            
            displayTotalEarnings.textContent = `$${finalTotalEarnings.toFixed(2)}`;
        }

        // Event Listener for the main calculation button
        calculateAllEarningsButton.addEventListener('click', calculateAllEarnings);

        // Event Listeners for Navigation
        navButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetId = button.dataset.target;

                // Hide all content sections
                contentSections.forEach(section => {
                    section.classList.add('hidden');
                });
                // Show the target section
                document.getElementById(targetId).classList.remove('hidden');

                // Update active state for navigation buttons
                navButtons.forEach(btn => {
                    btn.classList.remove('bg-emerald-700', 'hover:bg-emerald-600');
                    btn.classList.add('bg-stone-700', 'hover:bg-stone-600');
                });
                button.classList.remove('bg-stone-700', 'hover:bg-stone-600');
                button.classList.add('bg-emerald-700', 'hover:bg-emerald-600');
            });
        });

        // Accordion functionality for Scenarios & Support section
        accordions.forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                const arrow = header.querySelector('span:last-child');

                // Toggle visibility
                const isOpen = content.classList.contains('open');

                // Close all other accordions
                document.querySelectorAll('.accordion-content.open').forEach(openContent => {
                    if (openContent !== content) {
                        openContent.style.maxHeight = '0';
                        openContent.classList.remove('open');
                        openContent.classList.add('hidden');
                        openContent.previousElementSibling.querySelector('span:last-child').classList.remove('rotate-180');
                        openContent.previousElementSibling.querySelector('span:last-child').classList.add('rotate-0');
                    }
                });

                if (!isOpen) {
                    // Open accordion
                    content.classList.remove('hidden');
                    // Force a reflow for transition to work correctly
                    void content.offsetWidth;
                    content.style.maxHeight = content.scrollHeight + 'px'; // Set max-height for smooth transition
                    arrow.classList.remove('rotate-0');
                    arrow.classList.add('rotate-180');
                    content.classList.add('open');
                } else {
                    // Close accordion
                    content.style.maxHeight = '0'; // Collapse
                    content.classList.remove('open');
                    content.addEventListener('transitionend', function handler() {
                        content.classList.add('hidden');
                        content.removeEventListener('transitionend', handler);
                    }, { once: true });
                    arrow.classList.remove('rotate-180');
                    arrow.classList.add('rotate-0');
                }
            });
        });

        // Initialize on window load
        window.onload = function() {
            // Ensure accordion contents are hidden initially
            document.querySelectorAll('.accordion-content').forEach(content => {
                content.style.maxHeight = '0';
                content.classList.add('hidden');
            });

            // Trigger click on the first nav button to show the initial section
            if (navButtons.length > 0) {
                navButtons[0].click();
            }

            // Perform initial calculation on load with default values
            calculateAllEarnings();
        };
    </script>
</body>
</html>
